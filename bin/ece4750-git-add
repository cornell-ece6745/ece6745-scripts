#!/bin/bash
#=========================================================================
# ece5745-git-add [options]
#=========================================================================
#
#  -h  Display this message
#  -v  Verbose mode
#
# Adds all files which are currently tracked and display the new status
# in a format similar to brg-git-status.sh. You can use this to quickly
# stage files for commit and see what would be committed before actually
# executing the commit.
#
# Author : Christopher Batten
# Date   : August 18, 2009

set -e

#-------------------------------------------------------------------------
# Command line parsing
#-------------------------------------------------------------------------

function usage
{
  echo ""
  sed -n '3p' $0 | sed -e 's/#//'
  sed -n '5,/^$/p' $0 | sed -e 's/#//'
  exit 1
}

verbose=no
while getopts "hvr" OPTION; do
  case $OPTION in
    v)   verbose=yes ;;
    h|?) usage ;;
  esac
done

#-------------------------------------------------------------------------
# Main
#-------------------------------------------------------------------------

top_dir=`git rev-parse --show-cdup`
git add -u ${top_dir}

# git-xstatus

git diff --name-status | sed "s/^\\(.\\)[[:space:]]*/ \\1 /"
git diff --staged --name-status | sed "s/^\\(.\\)[[:space:]]*/*\\1 /"
git ls-files --directory --exclude-standard --others -t | sed "s/^/ /"

exit 0

